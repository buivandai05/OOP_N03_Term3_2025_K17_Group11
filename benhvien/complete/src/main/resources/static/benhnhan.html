<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>üßë‚Äç‚öïÔ∏è Qu·∫£n L√Ω B·ªánh Nh√¢n</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background: #f8f9fa; }
    h2 { text-align: center; margin-bottom: 30px; }
    .card { margin-bottom: 20px; }
    input, button { border-radius: 0.5rem; }
  </style>
</head>
<body>
<div class="container py-5">
  <h2>üßë‚Äçü§ù‚Äçüßë H·ªÜ TH·ªêNG QU·∫¢N L√ù B·ªÜNH NH√ÇN</h2>

  <!-- Form Th√™m B·ªánh Nh√¢n -->
  <div class="card shadow-sm p-4 mb-4">
    <h5 class="card-title mb-3">Th√™m B·ªánh Nh√¢n M·ªõi</h5>
    <form id="formAddPatient">
      <div class="row g-3 mb-3">
        <div class="col-md-3">
          <input type="text" class="form-control" placeholder="M√£ B·ªánh Nh√¢n" id="maBenhNhan" required>
        </div>
        <div class="col-md-3">
          <input type="text" class="form-control" placeholder="T√™n B·ªánh Nh√¢n" id="tenBenhNhan" required>
        </div>
        <div class="col-md-1">
          <input type="number" class="form-control" placeholder="Tu·ªïi" id="tuoi" required>
        </div>
        <div class="col-md-2">
          <input type="text" class="form-control" placeholder="Gi·ªõi T√≠nh" id="gioiTinh" required>
        </div>
        <div class="col-md-3">
          <input type="text" class="form-control" placeholder="ƒê·ªãa Ch·ªâ" id="diaChi" required>
        </div>
      </div>
      <div class="row g-3 mb-3">
        <div class="col-md-3">
          <input type="text" class="form-control" placeholder="S·ªë ƒêi·ªán Tho·∫°i" id="soDienThoai" required>
        </div>
        <div class="col-md-4">
          <input type="text" class="form-control" placeholder="Chu·∫©n ƒêo√°n" id="chuanDoan" required>
        </div>
        <div class="col-md-2 d-grid">
          <button type="submit" class="btn btn-primary">Th√™m</button>
        </div>
      </div>
    </form>
  </div>

  <!-- Danh S√°ch B·ªánh Nh√¢n -->
  <div class="card shadow-sm p-4">
    <h5 class="card-title mb-3">Danh S√°ch B·ªánh Nh√¢n</h5>
    <table class="table table-bordered table-striped" id="tblPatients">
      <thead class="table-dark">
        <tr>
          <th>M√£</th>
          <th>T√™n</th>
          <th>Tu·ªïi</th>
          <th>Gi·ªõi T√≠nh</th>
          <th>ƒê·ªãa Ch·ªâ</th>
          <th>ƒêi·ªán Tho·∫°i</th>
          <th>M√£ Ph√≤ng</th>
          <th>Chu·∫©n ƒêo√°n</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
</div>

<script>
  const API = 'http://localhost:8080/api/benhnhan'; // ƒê√É S·ª¨A URL API

  const form = document.getElementById('formAddPatient');
  const tbl = document.getElementById('tblPatients').querySelector('tbody');

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    const data = {
      maBenhNhan: document.getElementById('maBenhNhan').value.trim(),
      tenBenhNhan: document.getElementById('tenBenhNhan').value.trim(),
      tuoi: parseInt(document.getElementById('tuoi').value),
      gioiTinh: document.getElementById('gioiTinh').value.trim(),
      diaChi: document.getElementById('diaChi').value.trim(),
      soDienThoai: document.getElementById('soDienThoai').value.trim(),
      maPhong: document.getElementById('maPhong').value.trim(),
      chuanDoan: document.getElementById('chuanDoan').value.trim()
    };

    const res = await fetch(API, {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify(data)
    });
    const msg = await res.text();
    alert(msg);
    form.reset();
    loadPatients();
  });

  async function loadPatients() {
    const res = await fetch(API);
    const patients = await res.json();
    tbl.innerHTML = '';
    patients.forEach(p => {
      tbl.innerHTML += `<tr>
        <td>${p.maBenhNhan}</td>
        <td>${p.tenBenhNhan}</td>
        <td>${p.tuoi}</td>
        <td>${p.gioiTinh}</td>
        <td>${p.diaChi}</td>
        <td>${p.soDienThoai}</td>
        <td>${p.maPhong}</td>
        <td>${p.chuanDoan}</td>
      </tr>`;
    });
  }

  loadPatients();
</script>

</body>
</html>
